---
title: "Project1_RM"
output: html_document
---

Loading libraries and settings
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(geosphere)
options(scipen=999)
options(max.print=1000000)
```

Exploratory Data Analysis
```{r}
knitr::opts_chunk$set(echo = TRUE)
#MAC
#airbnb <- read.csv(file="/Users/reagan/Documents/_SMU/Spring_2020/Applied_Statistics/Applied_Stats_Project/Project_1/AB_NYC_2019.csv",header=TRUE)

#PC
airbnb <- read.csv(file="C:/Users/EREAMEA/Documents/_SMU/Applied Statistics/Semester Project/AB_NYC_2019.csv",header=TRUE)

airbnb <- filter(airbnb, substr(last_review, 1, 4) %in% c('2017', '2018', '2019'))

airbnb <- filter(airbnb, price >= 25 & price <= 400)

airbnb$id <- NULL
airbnb$name <- NULL
airbnb$host_id <- NULL
airbnb$host_name <- NULL
airbnb$host_listings <- airbnb$calculated_host_listings
airbnb$calculated_host_listings <- NULL

#Creating a new, tsquare_distance (distance to Times Square in miles)
for (i in 1:nrow(airbnb)) {
  n <- (distHaversine(c(airbnb$latitude[i], -airbnb$longitude[i]), c(40.7580, 73.9855)) / 1609.344)
  airbnb$tsquare_distance[i] <- n
}

selected_vars <- c('neighbourhood_group', 'neighbourhood', 'room_type', 'price', 'minimum_nights', 'number_of_reviews', 'reviews_per_month', 'host_listings', 'tsquare_distance', 'availability_365')
airbnb <- airbnb[selected_vars]

airbnb <- airbnb[!(airbnb$price==0),]
airbnb <- airbnb[!(airbnb$availability_365==0),]

airbnb_EH <- filter(airbnb, room_type == "Entire home/apt")
airbnb_PR <- filter(airbnb, room_type == "Private room")
airbnb_SR <- filter(airbnb, room_type == "Shared room")
```

Full data set regression fit with interaction term, no transformation
```{r}
fit <- lm(price ~ minimum_nights + number_of_reviews + tsquare_distance + neighbourhood + room_type + neighbourhood:room_type, data = airbnb)
summary(fit)
plot(fit)
```

Full data set regression fit with interaction term, log - linear transformation
```{r}
fit_log <- lm(log(price) ~ minimum_nights + number_of_reviews + tsquare_distance + neighbourhood + room_type + neighbourhood:room_type, data = airbnb)
summary(fit_log)
plot(fit_log)
``` 

Entire home/apt data set regression fit, log - linear transformation
```{r}
fit_EH <- lm(log(price) ~ minimum_nights + number_of_reviews + tsquare_distance + neighbourhood, data = airbnb_EH)
summary(fit_EH)
plot(fit_EH)
```

Private room data set regression fit, log - linear transformation
```{r}
fit_PR <- lm(log(price) ~ minimum_nights + number_of_reviews + tsquare_distance + neighbourhood, data = airbnb_EH)
summary(fit_EH)
plot(fit_PR)
```

Shared room data set regression fit, log - linear transformation
```{r}
fit_SR <- lm(log(price) ~ minimum_nights + number_of_reviews + tsquare_distance + neighbourhood, data = airbnb_EH)
summary(fit_SR)
plot(fit_SR)
```


